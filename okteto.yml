name: g1.users.api

build:
  api:
    context: . 
    
deploy:
  - helm upgrade --install users-ms chart
    --set api.image=${OKTETO_BUILD_API_IMAGE}
  - helm repo add datadog https://helm.datadoghq.com
  - helm install datadog-operator datadog/datadog-operator
  - kubectl apply -f chart/templates/datadog-agent.yaml
dev:
  api:
    command: uvicorn src.main:app --host 0.0.0.0 --port 3000
    forward:
      - 3000:3000
      - 5432:users-db:5432
    sync:
      - .:/usr/snapmsg-users

